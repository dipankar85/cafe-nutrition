{
    "collab_server" : "",
    "contents" : "library(packrat)\nlibrary(tidyverse)\nlibrary(rmarkdown)\nlibrary(Hmisc)\n\npre_primary <- read.csv(\"cns_pp_data.csv\", stringsAsFactors = FALSE)\n\nnames_preprimary <- c(\"timestamp\", \"first_name\", \"last_name\", \"gender\", \"age\", \"grade\",\n                      \"parent_name\", \"parent_email\", \"parent_phone\", \"sick\", \"new_food\", \"allergy\", \"dairy_milk\", \"dairy_curd\", \"dairy_cheese\",\n                      \"dairy_paneer\", \"vegetables\", \"fruits\",  \"whole_grains\", \"sugary_foods\", \"fast_food\", \"protein_fish\", \n                      \"protein_chicken\", \"protein_meat\", \"protein_eggs\", \"protein_dal\", \"protein_nuts\", \"water\", \"excercise\",\n                      \"screen\", \"priority\", \"more_often\", \"disappointed\", \"comment\")\n\npreprimary_clean <- pre_primary\n\ncolnames(preprimary_clean) <- names_preprimary\n\n\n\n\n#Adding extra columns \npreprimary_clean <- mutate(preprimary_clean,\n                           dairy_milk_p = dairy_milk,\n                           dairy_curd_p = dairy_curd,\n                           dairy_cheese_p = dairy_cheese,\n                           dairy_paneer_p = dairy_paneer,\n                           vegetables_p = vegetables,\n                           fruits_p = fruits,\n                           whole_grains_p = whole_grains,\n                           sugary_foods_p = sugary_foods,\n                           fast_food_p = fast_food,\n                           protein_fish_p = protein_fish,\n                           protein_chicken_p = protein_chicken,\n                           protein_meat_p = protein_meat,\n                           protein_eggs_p = protein_eggs,\n                           protein_dal_p = protein_dal,\n                           protein_nuts_p = protein_nuts)\n\n\n\n#changing text to numbers\n\n\n\npreprimary_clean$dairy_milk_p[preprimary_clean$dairy_milk_p == \"Never\"] <- 0\npreprimary_clean$dairy_milk_p[preprimary_clean$dairy_milk_p == \"1-2 days a week\"] <- 1\npreprimary_clean$dairy_milk_p[preprimary_clean$dairy_milk_p == \"3-4 days a week\"] <- 2\npreprimary_clean$dairy_milk_p[preprimary_clean$dairy_milk_p == \"5-6 days a week\"] <- 3\npreprimary_clean$dairy_milk_p[preprimary_clean$dairy_milk_p == \"All Days\"] <- 4\n\npreprimary_clean$dairy_curd_p[preprimary_clean$dairy_curd_p == \"Never\"] <- 0\npreprimary_clean$dairy_curd_p[preprimary_clean$dairy_curd_p == \"1-2 days a week\"] <- 1\npreprimary_clean$dairy_curd_p[preprimary_clean$dairy_curd_p == \"3-4 days a week\"] <- 2\npreprimary_clean$dairy_curd_p[preprimary_clean$dairy_curd_p == \"5-6 days a week\"] <- 3\npreprimary_clean$dairy_curd_p[preprimary_clean$dairy_curd_p == \"All Days\"] <- 4\n\npreprimary_clean$dairy_cheese_p[preprimary_clean$dairy_cheese_p == \"Never\"] <- 0\npreprimary_clean$dairy_cheese_p[preprimary_clean$dairy_cheese_p == \"1-2 days a week\"] <- 1\npreprimary_clean$dairy_cheese_p[preprimary_clean$dairy_cheese_p == \"3-4 days a week\"] <- 2\npreprimary_clean$dairy_cheese_p[preprimary_clean$dairy_cheese_p == \"5-6 days a week\"] <- 3\npreprimary_clean$dairy_cheese_p[preprimary_clean$dairy_cheese_p == \"All Days\"] <- 4\n\npreprimary_clean$dairy_paneer_p[preprimary_clean$dairy_paneer_p == \"Never\"] <- 0\npreprimary_clean$dairy_paneer_p[preprimary_clean$dairy_paneer_p == \"1-2 days a week\"] <- 1\npreprimary_clean$dairy_paneer_p[preprimary_clean$dairy_paneer_p == \"3-4 days a week\"] <- 2\npreprimary_clean$dairy_paneer_p[preprimary_clean$dairy_paneer_p == \"5-6 days a week\"] <- 3\npreprimary_clean$dairy_paneer_p[preprimary_clean$dairy_paneer_p == \"All Days\"] <- 4\n\n\npreprimary_clean$vegetables_p[preprimary_clean$vegetables_p == \"Never\"] <- 0\npreprimary_clean$vegetables_p[preprimary_clean$vegetables_p == \"1-2 days a week\"] <- 1\npreprimary_clean$vegetables_p[preprimary_clean$vegetables_p == \"3-4 days a week\"] <- 2\npreprimary_clean$vegetables_p[preprimary_clean$vegetables_p == \"5-6 days a week\"] <- 3\npreprimary_clean$vegetables_p[preprimary_clean$vegetables_p == \"All Days\"] <- 4\n\n\npreprimary_clean$fruits_p[preprimary_clean$fruits_p == \"Never\"] <- 0\npreprimary_clean$fruits_p[preprimary_clean$fruits_p == \"1-2 days a week\"] <- 1\npreprimary_clean$fruits_p[preprimary_clean$fruits_p == \"3-4 days a week\"] <- 2\npreprimary_clean$fruits_p[preprimary_clean$fruits_p == \"5-6 days a week\"] <- 3\npreprimary_clean$fruits_p[preprimary_clean$fruits_p == \"All Days\"] <- 4\n\npreprimary_clean$whole_grains_p[preprimary_clean$whole_grains_p == \"Never\"] <- 0\npreprimary_clean$whole_grains_p[preprimary_clean$whole_grains_p == \"1-2 days a week\"] <- 1\npreprimary_clean$whole_grains_p[preprimary_clean$whole_grains_p == \"3-4 days a week\"] <- 2\npreprimary_clean$whole_grains_p[preprimary_clean$whole_grains_p == \"5-6 days a week\"] <- 3\npreprimary_clean$whole_grains_p[preprimary_clean$whole_grains_p == \"All Days\"] <- 4\n\npreprimary_clean$sugary_foods_p[preprimary_clean$sugary_foods_p == \"Never\"] <- 4\npreprimary_clean$sugary_foods_p[preprimary_clean$sugary_foods_p == \"1-2 days a week\"] <- 4\npreprimary_clean$sugary_foods_p[preprimary_clean$sugary_foods_p == \"3-4 days a week\"] <- 2\npreprimary_clean$sugary_foods_p[preprimary_clean$sugary_foods_p == \"5-6 days a week\"] <- 1\npreprimary_clean$sugary_foods_p[preprimary_clean$sugary_foods_p == \"All Days\"] <- 0\n\n\npreprimary_clean$fast_food_p[preprimary_clean$fast_food_p == \"Never\"] <- 4\npreprimary_clean$fast_food_p[preprimary_clean$fast_food_p == \"1-2 days a week\"] <- 4\npreprimary_clean$fast_food_p[preprimary_clean$fast_food_p == \"3-4 days a week\"] <- 2\npreprimary_clean$fast_food_p[preprimary_clean$fast_food_p == \"5-6 days a week\"] <- 1\npreprimary_clean$fast_food_p[preprimary_clean$fast_food_p == \"All Days\"] <- 0\n\npreprimary_clean$protein_fish_p[preprimary_clean$protein_fish_p == \"Never\"] <- 0\npreprimary_clean$protein_fish_p[preprimary_clean$protein_fish_p == \"1-2 days a week\"] <- 1\npreprimary_clean$protein_fish_p[preprimary_clean$protein_fish_p == \"3-4 days a week\"] <- 2\npreprimary_clean$protein_fish_p[preprimary_clean$protein_fish_p == \"5-6 days a week\"] <- 3\npreprimary_clean$protein_fish_p[preprimary_clean$protein_fish_p == \"All Days\"] <- 4\n\n\npreprimary_clean$protein_chicken_p[preprimary_clean$protein_chicken_p == \"Never\"] <- 0\npreprimary_clean$protein_chicken_p[preprimary_clean$protein_chicken_p == \"1-2 days a week\"] <- 1\npreprimary_clean$protein_chicken_p[preprimary_clean$protein_chicken_p == \"3-4 days a week\"] <- 2\npreprimary_clean$protein_chicken_p[preprimary_clean$protein_chicken_p == \"5-6 days a week\"] <- 3\npreprimary_clean$protein_chicken_p[preprimary_clean$protein_chicken_p == \"All Days\"] <- 4\n\npreprimary_clean$protein_meat_p[preprimary_clean$protein_meat_p == \"Never\"] <- 0\npreprimary_clean$protein_meat_p[preprimary_clean$protein_meat_p == \"1-2 days a week\"] <- 1\npreprimary_clean$protein_meat_p[preprimary_clean$protein_meat_p == \"3-4 days a week\"] <- 2\npreprimary_clean$protein_meat_p[preprimary_clean$protein_meat_p == \"5-6 days a week\"] <- 3\npreprimary_clean$protein_meat_p[preprimary_clean$protein_meat_p == \"All Days\"] <- 4\n\npreprimary_clean$protein_eggs_p[preprimary_clean$protein_eggs_p == \"Never\"] <- 0\npreprimary_clean$protein_eggs_p[preprimary_clean$protein_eggs_p == \"1-2 days a week\"] <- 1\npreprimary_clean$protein_eggs_p[preprimary_clean$protein_eggs_p == \"3-4 days a week\"] <- 2\npreprimary_clean$protein_eggs_p[preprimary_clean$protein_eggs_p == \"5-6 days a week\"] <- 3\npreprimary_clean$protein_eggs_p[preprimary_clean$protein_eggs_p == \"All Days\"] <- 4\n\npreprimary_clean$protein_dal_p[preprimary_clean$protein_dal_p == \"Never\"] <- 0\npreprimary_clean$protein_dal_p[preprimary_clean$protein_dal_p == \"1-2 days a week\"] <- 1\npreprimary_clean$protein_dal_p[preprimary_clean$protein_dal_p == \"3-4 days a week\"] <- 2\npreprimary_clean$protein_dal_p[preprimary_clean$protein_dal_p == \"5-6 days a week\"] <- 3\npreprimary_clean$protein_dal_p[preprimary_clean$protein_dal_p == \"All Days\"] <- 4\n\npreprimary_clean$protein_nuts_p[preprimary_clean$protein_nuts_p == \"Never\"] <- 0\npreprimary_clean$protein_nuts_p[preprimary_clean$protein_nuts_p == \"1-2 days a week\"] <- 1\npreprimary_clean$protein_nuts_p[preprimary_clean$protein_nuts_p == \"3-4 days a week\"] <- 2\npreprimary_clean$protein_nuts_p[preprimary_clean$protein_nuts_p == \"5-6 days a week\"] <- 3\npreprimary_clean$protein_nuts_p[preprimary_clean$protein_nuts_p == \"All Days\"] <- 4\n\n\n\npreprimary_clean <- preprimary_clean %>%\n  mutate(water_p = ifelse(water == \"Rarely\", 2,\n                          ifelse(water == \"Mostly\", 4, NA))) %>%\n  mutate(excercise_p = ifelse(excercise == \"None\", 0,\n                              ifelse(excercise == \"15 minute\", 1,\n                                     ifelse(excercise == \"30 minutes\", 2, 4))))%>%\n  mutate(screen_p = case_when(.$screen == \"15-60 minutes\" ~ 4,\n                              .$screen == \"Never\" ~ 4,\n                              .$screen == \"1-2 hours\" ~ 3,\n                              .$screen == \"2-3 hours\" ~ 2,\n                              .$screen == \"3+ hours\" ~ 1))%>%\n  mutate(his_and_her = case_when(.$gender == \"Male\" ~ \"his\",\n                                 .$gender == \"Female\" ~ \"her\"))\n\n\npreprimary_clean[35:52] <- apply(preprimary_clean[35:52], 2, function(x) as.numeric(x))\n\n##USe MUTATE + CASE_WHEN NEXT TIME YOU MUTT\n\n\npreprimary_clean <- preprimary_clean %>%\n  mutate(dairy_total_p = dairy_milk_p + dairy_cheese_p + dairy_paneer_p +dairy_curd_p)%>%\n  mutate(dairy_variety_p = (dairy_milk_p > 0) + (dairy_cheese_p  > 0) + (dairy_paneer_p  > 0) + (dairy_curd_p  > 0 ))%>%\n  mutate(protein_total_p = protein_chicken_p +protein_dal_p + protein_eggs_p + protein_fish_p + protein_meat_p + protein_nuts_p)%>%\n  mutate(dairy_total_p = case_when(.$dairy_total_p >= 7 ~ 10,\n                                   .$dairy_total_p < 7 ~ .$dairy_total_p))%>%\n  mutate(protein_total_p = case_when(.$protein_total_p >= 7 ~ 10,\n                                     .$protein_total_p < 7 ~ .$protein_total_p))%>%\n  mutate(healthy_p = sugary_foods_p + fast_food_p)\n\n\n\n\npreprimary_clean <- mutate(preprimary_clean, total_p = vegetables_p + fruits_p + protein_total_p + dairy_total_p + dairy_variety_p +\n                             screen_p + water_p + excercise_p + sugary_foods_p)\npreprimary_clean <- mutate(preprimary_clean, first_name_c = capitalize(tolower(first_name)))\npreprimary_clean  <- mutate(preprimary_clean, full_name = paste(first_name_c, last_name, sep = \"_\"))\n\n\n\nfor (name in preprimary_clean$full_name){\n  subgroup <- preprimary_clean[preprimary_clean$full_name == name,]\n  render(input = \"cns_pp_report.rmd\",output_file = paste0(name, \"_\",  'report', '.pdf'))\n}\n\n",
    "created" : 1504190129040.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "976083475",
    "id" : "9B768424",
    "lastKnownWriteTime" : 1503438011,
    "last_content_update" : 1503438011,
    "path" : "C:/Users/rauna/OneDrive/Documents/Cafe-Nutrition/CNS Preprimary/cns_pp_script.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}